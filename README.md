# Emotion Recognition System

<div align="center">

![Python](https://img.shields.io/badge/Python-3.8%2B-blue)
![PyTorch](https://img.shields.io/badge/PyTorch-2.0%2B-red)
![YOLO](https://img.shields.io/badge/YOLO-Face%20Detection-green)
![ResNet](https://img.shields.io/badge/ResNet18-Backbone-orange)

**–°–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —ç–º–æ—Ü–∏–π –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –ª–∏—Ü**

</div>

## üìã –û –ø—Ä–æ–µ–∫—Ç–µ

–≠—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–≥–æ –∑—Ä–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è —Å–æ—á–µ—Ç–∞–µ—Ç –¥–µ—Ç–µ–∫—Ü–∏—é –ª–∏—Ü —Å –ø–æ–º–æ—â—å—é YOLO –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é —ç–º–æ—Ü–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º ResNet18. –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–ª–∏ –≤–∏–¥–µ–æ –ø–æ—Ç–æ–∫–∏ –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é.

### üîç –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å
1. **–î–µ—Ç–µ–∫—Ü–∏—è –ª–∏—Ü**: YOLO –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∏ –≤—ã—Ä–µ–∑–∞–µ—Ç –ª–∏—Ü–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
2. **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —ç–º–æ—Ü–∏–π**: ResNet18 –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–∞–∂–¥–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–µ –ª–∏—Ü–æ
3. **–í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º JSON-—Ñ–æ—Ä–º–∞—Ç–µ

## üòä –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–µ–º—ã–µ —ç–º–æ—Ü–∏–∏

–°–∏—Å—Ç–µ–º–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç 4 –æ—Å–Ω–æ–≤–Ω—ã–µ —ç–º–æ—Ü–∏–∏:

| –≠–º–æ—Ü–∏—è | –ú–µ—Ç–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-------|----------|
| **Happy** (–†–∞–¥–æ—Å—Ç—å) | 1 | –£–ª—ã–±–∫–∞, —Å–º–µ—Ö, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —ç–º–æ—Ü–∏–∏ |
| **Neutral** (–ù–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è) | 0 | –°–ø–æ–∫–æ–π–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –ª–∏—Ü–∞ |
| **Surprise** (–£–¥–∏–≤–ª–µ–Ω–∏–µ) | 0 | –®–∏—Ä–æ–∫–æ –æ—Ç–∫—Ä—ã—Ç—ã–µ –≥–ª–∞–∑–∞, —É–¥–∏–≤–ª–µ–Ω–∏–µ |
| **Embarrassment** (–°–º—É—â–µ–Ω–∏–µ) | 0 | –ù–µ–ª–æ–≤–∫–æ—Å—Ç—å, —Å–º—É—â–µ–Ω–∏–µ |

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install torch torchvision opencv-python ultralytics numpy pillow
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from emotion_detector import EmotionDetector

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞
detector = EmotionDetector()

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
result = detector.process_image("path/to/image.jpg")

# –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–∏—Ü–∞ –∏ —ç–º–æ—Ü–∏–∏
print(result)
```

### üìÑ –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ JSON

```json
{
  "image_path": "path/to/image.jpg",
  "faces_detected": 2,
  "results": [
    {
      "face_id": 0,
      "bbox": [100, 150, 200, 250],
      "emotions": {
        "Happy": 1,
        "Neutral": 0,
        "Surprise": 0,
        "Embarrassment": 0
      },
      "dominant_emotion": "Happy",
      "confidence": 0.95
    },
    {
      "face_id": 1,
      "bbox": [300, 120, 400, 220],
      "emotions": {
        "Happy": 0,
        "Neutral": 1,
        "Surprise": 0,
        "Embarrassment": 0
      },
      "dominant_emotion": "Neutral",
      "confidence": 0.87
    }
  ],
  "processing_time": 0.15
}
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –ú–æ–¥–µ–ª–∏ –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **–î–µ—Ç–µ–∫—Ü–∏—è –ª–∏—Ü**: YOLO (Ultralytics)
- **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —ç–º–æ—Ü–∏–π**: ResNet18 —Å –¥–æ–æ–±—É—á–µ–Ω–∏–µ–º
- **–§—Ä–µ–π–º–≤–æ—Ä–∫**: PyTorch
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**: OpenCV

### –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –º–æ–¥–µ–ª–∏

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤**: 4
- **Input size**: 224√ó224 –ø–∏–∫—Å–µ–ª–µ–π
- **–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞**: JSON —Å –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞**: Multiple faces detection

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
emotion-recognition/
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ emotion_resnet18.pth
‚îÇ   ‚îî‚îÄ‚îÄ yolo_face_detector.pt
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ face_detector.py      # YOLO –¥–µ—Ç–µ–∫—Ü–∏—è –ª–∏—Ü
‚îÇ   ‚îú‚îÄ‚îÄ emotion_classifier.py # ResNet18 –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ emotion_detector.py   # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ preprocess.py
‚îÇ       ‚îî‚îÄ‚îÄ visualization.py
‚îú‚îÄ‚îÄ examples/
‚îÇ   ‚îú‚îÄ‚îÄ single_face.jpg
‚îÇ   ‚îî‚îÄ‚îÄ group_photo.jpg
‚îú‚îÄ‚îÄ results/                  # –ü–∞–ø–∫–∞ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

```bash
# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
python src/emotion_detector.py --image path/to/image.jpg --output results/

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ–π –ø–∞–ø–∫–∏ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
python src/emotion_detector.py --folder path/to/images/ --output results/

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ–±-–∫–∞–º–µ—Ä—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
python src/emotion_detector.py --webcam
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **Accuracy** | [–î–æ–±–∞–≤—å—Ç–µ –≤–∞—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ] |
| **Inference Time** | ~150–º—Å –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ |
| **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ multiple faces** | ‚úÖ –î–∞ |
| **Real-time processing** | ‚úÖ –î–∞ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç hardware) |

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è**
```bash
git clone https://github.com/your-username/emotion-recognition.git
cd emotion-recognition
```

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
```bash
pip install -r requirements.txt
```

3. **–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π**
```bash
# –ú–æ–¥–µ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω—ã –≤ –ø–∞–ø–∫–µ models/
```

## üë• –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ

```python
from emotion_detector import EmotionDetector
import json

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
detector = EmotionDetector()

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
result = detector.process_image("test_image.jpg")

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
with open("result.json", "w") as f:
    json.dump(result, f, indent=2)

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
detector.visualize_result("test_image.jpg", result, "output.jpg")
```

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –î–µ—Ç–µ–∫—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ª–∏—Ü –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
- ‚úÖ –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —ç–º–æ—Ü–∏–π
- ‚úÖ –†–µ–∂–∏–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ JSON
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤–∏–¥–µ–æ –ø–æ—Ç–æ–∫–æ–≤

## ü§ù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–î–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –∏–ª–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏:

```bash
# –î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —ç–º–æ—Ü–∏–π
python src/train_emotion.py --data path/to/dataset/ --epochs 50
```

## üë• –ê–≤—Ç–æ—Ä—ã

- [–í–∞—à–µ –∏–º—è/–∫–æ–º–∞–Ω–¥–∞] - [–í–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã]


---

<div align="center">

**‚≠ê –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –ø–æ–ª–µ–∑–µ–Ω - –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é!**

</div>
```
